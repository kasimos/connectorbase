"sap/ui/core/mvc/Controller", "sap/ui/model/json/JSONModel"
Controller, JSONModel, InputFormatter
init : function() {
	var oModel = new JSONModel();
	var oStateModel = this.getView().getModel("state");
	var sConnectionname = jQuery.sap.getUriParameters().get("name");
	if (sConnectionname == null) {
		oModel.loadData("../rest/connection/template");
		this.onPressEdit(null);
		oStateModel.setProperty("/title", "Create new Connection");
	} else {
		oModel.loadData("../rest/connections/" + encodeURI(sConnectionname));
		oStateModel.setProperty("/title", "Connection settings");
	}
	this.getView().setModel(oModel);
	oStateModel.setProperty("/breadcrumbs", [ {"text" : "ConnectorStatus", "link" : "./ConnectorStatus"} ] );
},
edit : function(oEvent) {
},
save : function(oEvent) {
	var oModel = this.getView().getModel();
	var oStateModel = this.getView().getModel("state");
	var data = JSON.stringify(oModel.getJSON());
	var xmlhttp = new XMLHttpRequest();
	xmlhttp.open("POST", "../rest/connections/" + encodeURI(oStateModel.getProperty("/title")));
	xmlhttp.setRequestHeader("Content-Type", "application/json");
	xmlhttp.onreadystatechange = function() {
	    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
	        window.location.href = './ConnectorStatus';
	    } else {
	        alert(xmlhttp.responseText);
	    }
	}
	xmlhttp.send(oModel.getJSON());
},
cancel : function(oEvent) {
}
